{
  "version": 3,
  "sources": ["../src/PaginatedEpubViewer.ts"],
  "sourcesContent": ["/* eslint-disable no-console */\nimport debounce from 'debounce';\nimport { RenditionOptions } from 'epubjs/types/rendition';\nimport { EpubPaginator, PaginateEventPayload } from './EpubPaginator';\nimport { EpubViewer } from './EpubViewer';\n\nexport interface PaginationUpdateEventPayload extends PaginateEventPayload {\n\tcurrentPage?: number;\n}\nexport interface PaginationDoneEventPayload {\n\tpages: string[];\n\tcurrentPage?: number;\n}\n\nexport class PaginatedEpubViewer extends EpubViewer {\n\tprotected paginator: EpubPaginator;\n\tprotected pages: string[];\n\n\tpublic get currentPage() {\n\t\treturn this.pages ? this.pages.indexOf(this.currentLocation) + 1 : '-';\n\t}\n\n\tpublic async display(\n\t\telement: Element,\n\t\toptions?: RenditionOptions,\n\t\ttarget?: string,\n\t) {\n\t\tawait super.display(element, options, target);\n\t\tthis.paginate();\n\t}\n\n\tprotected async paginate() {\n\t\tif (this.paginator) {\n\t\t\tthis.paginator.destroy();\n\t\t\tdelete this.paginator;\n\t\t}\n\t\tthis.paginator = new EpubPaginator(this.book);\n\t\tthis.paginator.on('paginate', ({ pages, cfi }: PaginateEventPayload) => {\n\t\t\tthis.pages = pages;\n\t\t\tthis.emit('pagination-update', {\n\t\t\t\tpages,\n\t\t\t\tcfi,\n\t\t\t\tcurrentPage: this.currentPage,\n\t\t\t} as PaginationUpdateEventPayload);\n\t\t});\n\t\tthis.paginator.on('done', (pages) => {\n\t\t\tthis.pages = pages;\n\t\t\tthis.emit('pagination-done', {\n\t\t\t\tpages,\n\t\t\t\tcurrentPage: this.currentPage,\n\t\t\t} as PaginationDoneEventPayload);\n\t\t});\n\t\tawait this.paginator.paginate(this.size);\n\t}\n\n\tprotected registerEventListeners() {\n\t\tsuper.registerEventListeners();\n\t\t// paginate again after any resize\n\t\tthis.rendition.on(\n\t\t\t'resized',\n\t\t\tdebounce(async ({ width, height }) => {\n\t\t\t\tconsole.log(`Resized: ${width}x${height}`);\n\t\t\t\tawait this.paginate();\n\t\t\t}, 500),\n\t\t);\n\t}\n\n\tdestroy(): void {\n\t\tthis.paginator?.destroy();\n\t\tsuper.destroy();\n\t}\n}\n"],
  "mappings": "AACA;AAEA;AACA;AAUO,yCAAkC,WAAW;AAAA,MAIxC,cAAc;AACxB,WAAO,KAAK,QAAQ,KAAK,MAAM,QAAQ,KAAK,mBAAmB,IAAI;AAAA;AAAA,QAGvD,QACZ,SACA,SACA,QACC;AACD,UAAM,MAAM,QAAQ,SAAS,SAAS;AACtC,SAAK;AAAA;AAAA,QAGU,WAAW;AAC1B,QAAI,KAAK,WAAW;AACnB,WAAK,UAAU;AACf,aAAO,KAAK;AAAA;AAEb,SAAK,YAAY,IAAI,cAAc,KAAK;AACxC,SAAK,UAAU,GAAG,YAAY,CAAC,EAAE,OAAO,UAAgC;AACvE,WAAK,QAAQ;AACb,WAAK,KAAK,qBAAqB;AAAA,QAC9B;AAAA,QACA;AAAA,QACA,aAAa,KAAK;AAAA;AAAA;AAGpB,SAAK,UAAU,GAAG,QAAQ,CAAC,UAAU;AACpC,WAAK,QAAQ;AACb,WAAK,KAAK,mBAAmB;AAAA,QAC5B;AAAA,QACA,aAAa,KAAK;AAAA;AAAA;AAGpB,UAAM,KAAK,UAAU,SAAS,KAAK;AAAA;AAAA,EAG1B,yBAAyB;AAClC,UAAM;AAEN,SAAK,UAAU,GACd,WACA,SAAS,OAAO,EAAE,OAAO,aAAa;AACrC,cAAQ,IAAI,YAAY,SAAS;AACjC,YAAM,KAAK;AAAA,OACT;AAAA;AAAA,EAIL,UAAgB;AAnEjB;AAoEE,eAAK,cAAL,mBAAgB;AAChB,UAAM;AAAA;AAAA;",
  "names": []
}
